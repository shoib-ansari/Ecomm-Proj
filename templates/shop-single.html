{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>E-commerce</title>

    <!-- Core Style CSS -->
    <link rel="stylesheet" href="{% static 'css/core-style.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/aos.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/icomoon/style.css' %}">

    <!-- Responsive CSS -->
    <link href="{% static 'css/responsive.css' %}" rel="stylesheet">
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->

</head>

<body>
    <div class="site-wrap">
        <div class="site-navbar bg-white py-2">
            <div class="search-wrap">
                <div class="container">
                    <a href="#" class="search-close js-search-close"><span class="icon-close2"></span></a>
                    <form action="/products/show_results" method="GET" id="src_frm">
                        <input list="products_list" class="form-control" name="query" placeholder="search Here....." id="prod_search">
                        <datalist id="products_list">
              <!-- Datalist will append here -->
                    </datalist>
                    </form>
                </div>
            </div>
            <div class="container">
                <div class="d-flex align-items-center justify-content-between">
                    <div class="logo">
                        <div class="site-logo">
                            <a href="/" class="js-logo-clone">Dealers</a>
                            <!-- <a href="/test" class="js-logo-clone">Test</a> -->
                        </div>
                    </div>
                    <div class="main-nav d-none d-lg-block">
                        <nav class="site-navigation text-right text-md-center" role="navigation">
                            <ul class="site-menu js-clone-nav d-none d-lg-block">
                                {% for key , value in nav_products.items %}
                                <li class="has-children active">
                                    {% for i in main_cat_nav %} {% if i.name == key %}
                                    <a href="/products/sub_productsinM_of{{i.id}}" class="ansari">{{ key }}</a>
                                    {% endif %} {% endfor %}
                                    <ul class="dropdown">
                                        {% for i,j in value.items %}
                                        <li class="has-children">
                                            {% with j|first as first_object %}
                                            <a href="/products/sub_productsin{{first_object}}">{{i}}</a>
                                            <ul class="dropdown">
                                                {% for k in j %} {% if k.0 %}
                                                <li><a href="/products/sub_productsin{{first_object}}in{{k.0}}">{{k.1}}</a></li>
                                                {% endif %} {% endfor %}
                                            </ul>
                                            {% endwith %}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                                {% endfor %} {% if request.user.is_authenticated %}
                                <li class="has-children active">
                                    <big><a><span class="icon-user-o"></span> &nbsp;{{user.username}}</big></a>
                                    <ul class="dropdown">
                                        <li><a href="/userprofile">My Account</a></li>
                                        <li><a href="/orderprocessing/order_history">Order-history</a></li>
                                        {% if notification %}
                                        <li><a href="/notifications" id="not_dot">Notifications</a></li>
                                        {% else %}
                                        <li><a href="/notifications">Notifications</a></li>
                                        {% endif %}
                                        <li><a href="/manage_address">Manage Address</a></li>
                                        <li><a href="/logut">Logout</a></li>
                                    </ul>
                                </li>
                                {% endif %}
                            </ul>
                        </nav>
                    </div>
                    <div class="icons">
                        <a href="#" class="icons-btn d-inline-block js-search-open"><span class="icon-search"></span></a>
                        <a href="#" class="icons-btn d-inline-block"><span class="icon-heart-o"></span></a>
                        <a href="/cart" class="icons-btn d-inline-block bag">
                            <span class="icon-shopping-bag"></span>
                            <span class="number">2</span>
                        </a>
                        {% if request.user.is_authenticated %}
                        <!-- <span class="icon-user-o">My Profile -->
                        {% else %}
                        <a href="#" class="icons-btn d-inline-block"><span class="icon-user-o"></span></a> {% endif %}

                        <a href="#" class="site-menu-toggle js-menu-toggle ml-3 d-inline-block d-lg-none"><span
                class="icon-menu"></span></a>
                    </div>
                </div>
            </div>
        </div>


        <!-- NAVBAR ENDS HERE -->
        <div class="bg-light py-3">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 mb-0"><a href="index.html">Home</a> <span class="mx-2 mb-0">/</span> <a
                            href="shop.html">Shop</a> <span class="mx-2 mb-0">/</span> <strong class="text-black">The
                            Shoe</strong></div>
                </div>
            </div>
        </div>


        <div id="wrapper">
            <!-- <<<<<<<<<<<<<<<<<<<< Breadcumb Area Start <<<<<<<<<<<<<<<<<<<< -->
            <div class="breadcumb_area">
                <div class="container">
                    <div class="row">
                        <div class="col-12">
                            <ol class="breadcrumb d-flex align-items-center">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item"><a href="#">Dresses</a></li>
                                <li class="breadcrumb-item active">Long Dress</li>
                            </ol>
                            <!-- btn -->
                            <a href="#" class="backToHome d-block"><i class="fa fa-angle-double-left"></i> Back to
                                Category</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <<<<<<<<<<<<<<<<<<<< Breadcumb Area End <<<<<<<<<<<<<<<<<<<< -->

            <!-- <<<<<<<<<<<<<<<<<<<< Single Product Details Area Start >>>>>>>>>>>>>>>>>>>>>>>>> -->
            <section class="single_product_details_area section_padding_0_100">
                <div class="container">
                    <div class="row">

                        <div class="col-12 col-md-6">
                            <div class="single_product_thumb">
                                <div id="product_details_slider" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        {% with color_variation|first as first_object %}
                                        {% if first_object.Image_one %}
                                        <li class="active" data-target="#product_details_slider" data-slide-to="0"> <img
                                                id="car_img_1" src="{{first_object.Image_one.url}}">
                                        </li>
                                        {% endif %}
                                        {% if first_object.Image_two %}
                                        <li data-target="#product_details_slider" data-slide-to="1"> <img id="car_img_2"
                                                src="{{first_object.Image_two.url }}">
                                        </li>
                                        {% endif %}
                                        {% if first_object.Image_three %}
                                        <li data-target="#product_details_slider" data-slide-to="2"> <img id="car_img_3"
                                                src="{{first_object.Image_three.url}}">
                                        </li>
                                        {% endif %}
                                        {% if first_object.Image_four %}
                                        <li data-target="#product_details_slider" data-slide-to="3"> <img id="car_img_4"
                                                src="{{first_object.Image_four.url}}">
                                        </li>
                                        {% endif %}
                                        {% endwith %}
                                    </ol>

                                    <div class="carousel-inner detmain">

                                        {% with color_variation|first as first_object %}
                                        {% if first_object.Image_one %}
                                        <div class="carousel-item active">
                                            <img id="img_1" class="d-block w-100 img-fluid img_one"
                                                src="{{first_object.Image_one.url}}" alt="First slide">
                                        </div>
                                        {% endif %}
                                        {% if first_object.Image_two %}
                                        <div class="carousel-item">
                                            <img id="img_2" class="d-block w-100 img-fluid img_two"
                                                src="{{first_object.Image_two.url}}" alt="Second slide">
                                        </div>
                                        {% endif %}
                                        {% if first_object.Image_three %}
                                        <div class="carousel-item">
                                            <img id="img_3" class="d-block w-100 img-fluid img_three"
                                                src="{{first_object.Image_three.url}}" alt="Second slide">
                                        </div>
                                        {% endif %}
                                        {% if first_object.Image_four %}
                                        <div class="carousel-item">
                                            <img id="img_4" class="d-block w-100 img-fluid img_four"
                                                src="{{first_object.Image_four.url}}" alt="Second slide">
                                        </div>
                                        {% endif %}
                                        {% endwith %}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 col-md-6">
                            <div class="single_product_desc">
                                <h4 class="title"><a href="#">{{product.Product_Name}}</a></h4>
                                <h4 class="price">$ {{product.Current_Price}}</h4>
                                <p class="available">Colors Available: <span class="text-muted">In Stock</span></p>
                                <div class="related_color_row">
                                    {% for i in color_variation %}
                                    <div class="col-md-2 " id="color_var_{{i.id}}">
                                            <img src="{{i.Image_one.url}}" class="img-fluid">
                                            <div class="pl-3">{{i.color}}</div>
                                    </div>
                                    {% endfor %}
                                </div>
                                <div class="single_product_ratings mb-5">
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star" aria-hidden="true"></i>
                                    <i class="fa fa-star-o" aria-hidden="true"></i>
                                </div>

                                <div class="widget size mb-50">
                                    <h6 class="widget-title">Size</h6>
                                    <div class="widget-desc">
                                        <ul id=size_list>
                                        </ul>
                                    </div>
                                </div>
                                <!-- Add to Cart Form -->
                                <form class="cart clearfix mb-50 d-flex" method="POST" action="#">
                                    {% csrf_token %}
                                    <div class="quantity">
                                        <span class="qty-plus"
                                            onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN( qty )) effect.value++;return false;"><i
                                                class="fa fa-plus" aria-hidden="true"></i>
                                            <div>+</div>
                                        </span>

                                        <input type="number" class="qty-text" id="qty" step="1" min="1" max="12"
                                            name="quantity" value="1" readonly>
                                        {% with color_variation|first as first_object %}
                                        <input type="hidden" name="color" id="prod_color" value="{{first_object.id}}">
                                        {% endwith %}
                                        <input type="hidden" name="size" id="prod_size" value="">
                                        <span class="qty-minus"
                                            onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN( qty ) &amp;&amp; qty &gt; 1 ) effect.value--;return false;"><i
                                                class="fa fa-minus" aria-hidden="true"></i>
                                            <div>-</div>
                                        </span>

                                    </div>

                                    <span onclick="check_add_cart_status()" class="btn cart-submit d-block"
                                        id="add_cart">Add
                                        to
                                        cart</span>
                                </form>
                               

                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- <<<<<<<<<<<<<<<<<<<< Single Product Details Area End >>>>>>>>>>>>>>>>>>>>>>>>> -->

            <!-- ****** Quick View Modal Area Start ****** -->
            <div class="modal fade" id="quickview" tabindex="-1" role="dialog" aria-labelledby="quickview"
                aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <button type="button" class="close btn" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <div class="modal-body">
                            <div class="quickview_body">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-12 col-lg-5">
                                            <div class="quickview_pro_img">
                                                <img src="{% static 'images/product_1.jpg' %}" alt="">
                                            </div>
                                        </div>
                                        <div class="col-12 col-lg-7">
                                            <div class="quickview_pro_des">
                                                <h4 class="title">Boutique Silk Dress</h4>
                                                <div class="top_seller_product_rating mb-15">
                                                    <i class="fa fa-star" aria-hidden="true"></i>
                                                    <i class="fa fa-star" aria-hidden="true"></i>
                                                    <i class="fa fa-star" aria-hidden="true"></i>
                                                    <i class="fa fa-star" aria-hidden="true"></i>
                                                    <i class="fa fa-star" aria-hidden="true"></i>
                                                </div>
                                                <h5 class="price">$120.99 <span>$130</span></h5>
                                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia
                                                    expedita quibusdam aspernatur, sapiente consectetur accusantium
                                                    perspiciatis praesentium eligendi, in fugiat?</p>
                                                <a href="#">View Full Product Details</a>
                                            </div>
                                            <!-- Add to Cart Form -->
                                            <form class="cart" method="post">
                                                <div class="quantity">
                                                    <span class="qty-minus"
                                                        onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN( qty ) &amp;&amp; qty &gt; 1 ) effect.value--;return false;"><i
                                                            class="fa fa-minus" aria-hidden="true"></i></span>

                                                    <input type="number" class="qty-text" id="qty2" step="1" min="1"
                                                        max="12" name="quantity" value="1">

                                                    <span class="qty-plus"
                                                        onclick="var effect = document.getElementById('qty'); var qty = effect.value; if( !isNaN( qty )) effect.value++;return false;"><i
                                                            class="fa fa-plus" aria-hidden="true"></i></span>
                                                </div>
                                                <button type="submit" name="addtocart" value="5" class="cart-submit">Add
                                                    to
                                                    cart</button>
                                                <!-- Wishlist -->
                                                <div class="modal_pro_wishlist">
                                                    <a href="wishlist.html" target="_blank"><i class="ti-heart"></i></a>
                                                </div>
                                                <!-- Compare -->
                                                <div class="modal_pro_compare">
                                                    <a href="compare.html" target="_blank"><i
                                                            class="ti-stats-up"></i></a>
                                                </div>
                                            </form>

                                            <div class="share_wf mt-30">
                                                <p>Share With Friend</p>
                                                <div class="_icon">
                                                    <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                                    <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                                    <a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a>
                                                    <a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ****** Quick View Modal Area End ****** -->




            <div class="container-fluid p-5" id="ratenrev">
                <div class="sshd">
                    Customer Ratings
                    <h1 class="pl-2">4<span class="icon-star-o ml-1" style="font-size: 1.7rem;"></span><span class="headrt" style="margin-left: 5px !important;">Avg. rating and reviews</span></h1>
                </div>
                <div class="row justify-content-start">
                    <button class="rtrbt btn btn-outline-dark " id="newrevbtn">Rate or Write aReview</button>
                </div>
                <div class="container-fluid" id="reviewformdiv" style="display: none; overflow: hidden;">
                    <div class="container-fluid ratediv ">
                        <div class="row Rating mt-2">
                            <span rat="1" class="fas icon-star"></span>
                            <span rat="2" class="fas icon-star"></span>
                            <span rat="3" class="fas icon-star"></span>
                            <span rat="4" class="fas icon-star"></span>
                            <span rat="5" class="fas icon-star"></span>
                        </div>
                        <div class="row Rating m-2">
                            <big id="skip"> Skip Rating And Write A Review → </big>
                        </div>
                    </div>
                    <div class="container-fluid review" style="display: none;" >

                        <form method="POST" class="pt-3" id="review_form" action="/products/get_images" class="mt-2" enctype="multipart/form-data">
                            {% csrf_token %}
                            <label for="image_inp" class="m-0">
                                <span class="icon-camera"></span>&nbsp;<span>Upload </span>
                            </label>
                            <input type="file" name="reviewimages" id="image_inp" multiple
                                accept="image/gif,image/jpeg,image/jpg,image/png" hidden>
                            <div class="form-group m-0">
                                <!-- <label for="exampleFormControlTextarea1"> Write your Review About this product ..
                                </label> -->
                                <textarea class="form-control border-dark col-md-6" id="review" rows="3" required name="review"
                                    placeholder="Write your Review About this product here.."></textarea>
                            </div>
                            <input type="hidden" name="p_id" value="{{product.id}}">
                            <div class="row py-2" >
                                <button type="submit" id="review_text" class="rtrbt sbtn btn btn-outline-dark"> Submit
                                    &nbsp;<span class=" icon-paper-plane-o"></span></button>
                            </div>
                        </form>

                    </div>
                </div>
                <div class="sshd " id="rwflg">
                   Reviews
                </div>
                {% for i in reviews %}
                <!-- RATING STARTS HERE -->
                    <div class="row pl-3 headrt border-bottom pb-2" id="{{i.id}}">
                        <div class="row w-100">
                            <div class="ratingspec">{{i.rating }}</div><span class="icon-star"></span></span> <div class="reviewname">{{i.user.first_name}}</div>, 
                        </div>
                        <p class="row cmt my-3 reviewtext">{{i.review }}</p>
                    </div>
                <!-- RATING ENDS HERE -->
                {% endfor %}
            </div>

            <!-- Related Products -->
            <div class="container-fluid ">
                <div class="row title-section mt-5">
                    <h3 class="cathead" style="margin:auto;"> Related Products</h3>
                    <div class="col-md-12 block-3 products-wrap">
                        <div class="nonloop-block-3 owl-carousel rel_car">
                            {% for i in related_products %}
              
                            <div class=" product product_crd">
                              <!-- <a href="/products/view_?{{i.id}}" target="_blank" class="item">
                                <button class="vd_btn">VIEW DETAILS</button>
                                </a> -->
                              {% if i.id in wishlist %}
                              <i id="wish_obj_{{i.id}}" data-prod_id={{i.id}} onclick="add_to_wish(this,{{i.id}})"
                                class="fa fa-heart liked"></i>
                              {% else %}
                              <i id="wish_obj_{{i.id}}" data-prod_id="{{i.id}}" onclick="add_to_wish(this,{{i.id}})"
                                class="fa fa-heart"></i>
                              {% endif %}
                              <a href="/products/view_?{{i.id}}" >
                              <img src="{{i.image.url}}" alt="Image" class="fit"></a>
                              <div class="container-fluid pdesc m-0 pb-4  ">
                                                      <div class="row pr-3 justify-content-between">
                                                          <div class="col-md-7 pname ellp">
                                                              {{i.Product_Name}}
                                                          </div>
                                                          <div class="col-md-5">
                                                            ₹{{i.Price}} 
                                                            &nbsp;₹<strike class="text-muted">{{i.Current_Price}}</strike>
              
                                                          </div>
                                                      </div>
                                                       <a href="/products/view_?{{i.id}}" class="prdesc">
              
                                                      <div class="row m-0 pdtxt">
                                                          Mens Formal jeans and trousers for all sizes and colors
                                                      </div>
                                                          <div class="row pdhed m-n dninm">
                                                              <span class="pname">Sizes - <span class="text-dark" >xl,l,m,xxl</span> </span>
                                                          </div>
                                                          <div class="row pdhed dninm">
                                                            <span class="pname">Colors - <span class="text-dark" >xl,l,m,xxl</span></span>
                                                        </div>
                                                        </a>
              
                                                  </div>
                                                </div>
                            {% endfor %}

                        </div>
                    </div>
                </div>
            </div>


            <!-- Related Products -->

            <!-- ****** Footer Area Start ****** -->
            <footer class="footer_area">
                <div class="container">
                    <div class="row">
                        <!-- Single Footer Area Start -->
                        <div class="col-12 col-md-6 col-lg-3">
                            <div class="single_footer_area">

                                <div class="copywrite_text d-flex align-items-center">

                                </div>
                            </div>
                        </div>
                        <!-- Single Footer Area Start -->
                        <div class="col-12 col-sm-6 col-md-3 col-lg-2">
                            <div class="single_footer_area">
                                <ul class="footer_widget_menu">
                                    <li><a href="#">About</a></li>
                                    <li><a href="#">Blog</a></li>
                                    <li><a href="#">Faq</a></li>
                                    <li><a href="#">Returns</a></li>
                                    <li><a href="#">Contact</a></li>
                                </ul>
                            </div>
                        </div>
                        <!-- Single Footer Area Start -->
                        <div class="col-12 col-sm-6 col-md-3 col-lg-2">
                            <div class="single_footer_area">
                                <ul class="footer_widget_menu">
                                    <li><a href="#">My Account</a></li>
                                    <li><a href="#">Shipping</a></li>
                                    <li><a href="#">Our Policies</a></li>
                                    <li><a href="#">Afiliates</a></li>
                                </ul>
                            </div>
                        </div>
                        <!-- Single Footer Area Start -->
                        <div class="col-12 col-lg-5">
                            <div class="single_footer_area">
                                <div class="footer_heading mb-30">
                                    <h6>Subscribe to our newsletter</h6>
                                </div>
                                <div class="subscribtion_form">
                                    <form action="#" method="post">
                                        <input type="email" name="mail" class="mail" placeholder="Your email here">
                                        <button type="submit" class="submit">Subscribe</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="line"></div>

                    <!-- Footer Bottom Area Start -->
                    <div class="footer_bottom_area">
                        <div class="row">
                            <div class="col-12">
                                <div class="footer_social_area text-center">
                                    <a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a>
                                    <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                                    <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                                    <a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- ****** Footer Area End ****** -->
        </div>
    </div>
    <!-- /.wrapper end -->
    <div class="messaged">
    </div>
    <div id="loading_area" style="display: none;">
        <span class="spinner-border spinner-border-lg" role="status" aria-hidden="true"></span>
    </div>
    <input type="hidden" name="prod_id" id="p_id" value="{{product.id}}">

    <!-- jQuery (Necessary for All JavaScript Plugins) -->
    <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
    <!-- Popper js -->
    <script src="{% static 'js/popper.min.js' %}"></script>
    <!-- Bootstrap js -->
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- Plugins js -->
    <script src="{% static 'js/plugins.js' %}"></script>
    <!-- Active js -->
    <script src="{% static 'js/active.js' %}"></script>
    <!-- carousel js -->
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'js/aos.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script>      
        $('.owl-carousel').owlCarousel({
            loop: false,
            margin: 10,
            nav: true,
            responsive: {
                0: {
                    items: 2
                },
                600: {
                    items: 3
                },
                1000: {
                    items: 5
                }
            }
        });
        var prod_id =document.getElementById('p_id').value
        function check_add_cart_status() {
            var color = $('#prod_color').val()
            var size = $('#prod_size').val()
            var quantity = $('.qty-text').val()
            var list_length = $('#size_list li').length
            if (color == '' || size == '' && list_length > 0) {
                alert(list_length)
                $('.messaged').html('<div class="message">Select size first..</div>')
                setTimeout(function () { $('.messaged').empty() }, 2000);
            }
            else {
                $.ajax({
                    url: '/cart/add_to_cart',
                    type: 'get',
                    data: {
                        'Color': color,
                        'size': size,
                        'prod_id': prod_id,
                        'quantity': quantity
                    },
                    beforeSend: function () {
                        $('#loading_area').show();
                    },
                    success: function (data) {
                        $('.messaged').html('<div class="message">Product added to cart successfully...</div>')
                        setTimeout(function () { $('.messaged').empty() }, 2000);
                        $('.number').html(data)
                    }
                }
                )
            }
        }
        $(function () {
            $('#quesbtn').click(function () {
                $('#ratebtn').removeClass("b-bottom");
                $('#quesbtn').addClass("b-bottom");
                $('#ratingdiv').hide();
                $('#questiondiv').fadeIn(500);
            });
            $('#ratebtn').click(function () {
                $('#quesbtn').removeClass("b-bottom");
                $('#ratebtn').addClass("b-bottom");

                $('#questiondiv').hide();
                $('#ratingdiv').fadeIn(500);
            });
            $('#newrevbtn').click(function () {
                $('#reviewformdiv').fadeToggle(400);
            });
            $('#skip').click(function () {
                $('.ratediv').hide(500);
                $('.review').fadeIn(500);
            });
            $('vfilebtn').click(function () {
                $('filebtn').click();
            });
            {% for i, j in sizes.items %}
            {% if forloop.counter == 1 %}
            {% for k in j %}
            var temp = document.createElement("LI")
            var new_temp = document.createElement("A")
            temp_id = "set_size_to_" + "{{k}}"
            temp.innerHTML = "{{k}}"
            temp.setAttribute('id', temp_id);
            document.getElementById('size_list').appendChild(temp);
            temp.setAttribute('data-size', "{{k}}");
            temp.addEventListener('click', function () {
                // alert(this.getAttribute('data-size'))
                $sizes = $("[id^=set_size_to_]")
                $sizes.css("background-color", "white");
                this.style.backgroundColor = "#ff084e";
                $('#prod_size').val(this.getAttribute('data-size'))
            })
            // alert("{{k}}")
            {% endfor %}
            {% endif %}
            {% endfor %}
            $products = $("[id^=color_var_]")
            $products.click(function (e) {
                $('#prod_size').val('')
                $clicked_element = ($(this).attr('id'))
                $temp_clicked_id = $clicked_element.split("var_")
                var clicked_id = $temp_clicked_id[1]
                $('#prod_color').val(clicked_id);
                {% for i in color_variation %}
                var curr_id = "{{i.id}}"
                console.log(curr_id)
                if (clicked_id == curr_id) {
                    var prod_id = "color_var_".concat(curr_id)
                    var car_img_1 = document.getElementById('car_img_1')
                    {% if i.Image_one %}
                    document.getElementById('car_img_1').setAttribute('src', "{{i.Image_one.url}}");
                    document.getElementById('img_1').setAttribute('src', "{{i.Image_one.url}}");
                    {% endif %}
                    {% if i.Image_two %}
                    document.getElementById('car_img_2').setAttribute('src', "{{i.Image_two.url}}");
                    document.getElementById('img_2').setAttribute('src', "{{i.Image_two.url}}");
                    {% endif %}
                    {% if i.Image_three %}
                    document.getElementById('car_img_3').setAttribute('src', "{{i.Image_three.url}}");
                    document.getElementById('img_3').setAttribute('src', "{{i.Image_three.url}}");
                    {% endif %}
                    {% if i.Image_four %}
                    document.getElementById('car_img_4').setAttribute('src', "{{i.Image_four.url}}");
                    document.getElementById('img_4').setAttribute('src', "{{i.Image_four.url}}");
                    {% endif %}
                }
                {% endfor %}
                $('#size_list').empty();
                {% for i, j in sizes.items %}
                var size_temp = "{{i}}"
                if (clicked_id == size_temp) {
                    {% for k in j %}
                    var temp = document.createElement("LI")
                    var new_temp = document.createElement("A")
                    var temp_id = "set_size_to_" + "{{k}}"
                    temp.innerHTML = "{{k}}"
                    temp.setAttribute('id', temp_id);
                    document.getElementById('size_list').appendChild(temp);
                    temp.setAttribute('data-size', "{{k}}");
                    temp.addEventListener('click', function () {
                        // alert(this.getAttribute('data-size'))
                        $sizes = $("[id^=set_size_to_]")
                        $sizes.css("background-color", "white");
                        this.style.backgroundColor = "#ff084e";
                        $('#prod_size').val(this.getAttribute('data-size'))
                    })
                    {% endfor %}
                }
                {% endfor %}
            });
        });
    </script>

    <!-- script for rating and reviews -->
    <script>
        var p_id = document.getElementById('p_id').value
        $('.icon-star-o').click(function () {
            rate = $(this).attr('rat')
            $.ajax({
                url: '/products/rate',
                type: 'get',
                data: {
                    prod_id: p_id,
                    rate: rate
                },
                beforeSend: function () {
                    // alert("updating")
                }, success: function (data) {
                    // alert(data)
                    data = data.split("^")
                    if (data[0] == "Denied") {
                        alert("can't updated")
                    }
                    else {
                        // alert("wait")
                        $('.ratediv').hide(500);
                        $('.review').fadeIn(500);
                    }
                }
            })
        })



        // --------------------------  SUBMIT RATING  ------------------

        $('#review_form').submit(function (e) {
            // var images = new Object()
            var images = document.getElementById('image_inp').files
            alert(images.length)
            review = $('#review').val()
            if(images.length == 0){
                e.preventDefault();
                $.ajax({
                    url: '/products/review',
                    type: 'get',
                    data: {
                        review : review,
                        prod_id : p_id,
                    },
                    beforeSend: function () {
                        // alert("sending")
                    },
                    success: function (data) {
                        data = data.split('~')
                        flag = data[0]
                        rev_id = data[1]
                        name = data[2]
                        rating = data[3]
                        review = data[4]
                        var elementExists = document.getElementById(rev_id);
                        if(elementExists){
                            $('#'+rev_id).find(".reviewname").text(name)
                            $('#'+rev_id).find(".ratingspec").text(rating)
                            $('#'+rev_id).find(".reviewtext").text(review)
                            temp = 1
                            $("#review_form")[0].reset()
                            $('#reviewformdiv').hide(100)
                        }
                        else{
                            $('#rwflg').after('<div class="row pl-3 headrt border-bottom pb-2" id="'+rev_id+'"><div class="row w-100"> <div class="ratingspec">'+rating+'</div><span class="icon-star"></span> by &nbsp;</span> <div class="reviewname">'+name+'</div><span class="icon-commenting-o pt-1 mx-1 text-dark"></span>,</div> <p class="row cmt my-3 reviewtext">'+review+'</p> </div></div>')
                            }
                    }
                })
            }
            // else{
            //     // $('#review_form').submit();
            // }
        })

    </script>
</body>

</html>